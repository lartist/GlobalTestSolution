This app is a solution to the test: https://github.com/armel/GlobTest

Answers:

1. The function foo takes all the intervals given as input and factors them all by combining the intervals that have an intersection.
   It returns the new collection of factored intervals.
2. See the code
3. It takes me 3 hours :(